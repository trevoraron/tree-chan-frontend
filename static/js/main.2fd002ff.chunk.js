(this["webpackJsonptree-chan-frontend"]=this["webpackJsonptree-chan-frontend"]||[]).push([[0],{68:function(e,t){},87:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),s=n(26),c=n.n(s),i=n(2),o=n.n(i),u=n(21),j=n(14),d=n(91),l=n(97),b=n(93),O=n(22),x=n(17),f=n(90),p=n(95),h=n(92),g=n(55),m=n(94),v="0x443E1B83F486Ac849A1C0D9A37986E3e3448f4df",w=["function getMessage(uint256 _token) external view returns (string message)","function ownerOf(uint256 _tokenId) external view returns (address)","function getParents(uint256 _token) external view returns (uint256[] memory)","function getBranches(uint256 _token) external view returns (uint256[] memory)","function newThread(string memory _message) public returns (uint256)","function comment(uint256 _post, string memory _message)","function totalSupply() external view returns (uint256)","function balanceOf(address _owner) external view returns (uint256)","function tokenOfOwnerByIndex(address _owner, uint256 _index) external view returns (uint256)","event Transfer(address indexed _from, address indexed _to, uint256 indexed _tokenId)"],k=n(6);function S(e){var t=Object(r.useState)(!1),n=Object(j.a)(t,2),a=n[0],s=n[1],c=Object(r.useState)(""),i=Object(j.a)(c,2),b=i[0],x=i[1];function h(){return g.apply(this,arguments)}function g(){return(g=Object(u.a)(o.a.mark((function t(){var n,r,a,c,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createNewFunction(b);case 2:return n=t.sent,console.log("Transaction hash: ".concat(n.hash)),s(!0),t.next=7,n.wait();case 7:r=t.sent,console.log("Transaction confirmed in block ".concat(r.blockNumber)),a=new O.a.utils.Interface(w),c=a.parseLog(r.events[0]),i=c.args._tokenId,console.log("New Token ID: ".concat(i)),x(""),s(!1),e.updateID(i);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var m=Object(k.jsx)(p.a,{onSubmit:function(e){e.preventDefault()},children:Object(k.jsx)(p.a.Control,{as:"textarea",rows:2,value:b,onChange:function(e){return x(e.target.value)}})});return a&&(m=Object(k.jsxs)(f.a,{children:[Object(k.jsx)(d.a,{animation:"border",role:"status"}),"\xa0"]})),Object(k.jsxs)(k.Fragment,{children:[m,"\xa0",Object(k.jsx)(l.a,{variant:"primary",onClick:Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:case"end":return e.stop()}}),e)}))),children:e.name})]})}var y=n(96);function C(e){var t=Object(r.useState)(""),n=Object(j.a)(t,2),a=n[0],s=n[1],c=Object(r.useState)(""),i=Object(j.a)(c,2),b=i[0],x=i[1];Object(r.useEffect)((function(){var t=new O.a.Contract(v,w,e.signer);(function(){var n=Object(u.a)(o.a.mark((function n(){var r,a;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.ownerOf(e.id);case 2:return r=n.sent,n.next=5,t.getMessage(e.id);case 5:a=n.sent,s(a),x(r);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[e.id,e.signer]);var f=Object(k.jsx)(d.a,{animation:"border",role:"status"});return""!==a&&(f=Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)(y.a.Subtitle,{children:["Owner: ",b]}),Object(k.jsx)(y.a.Text,{children:a})]})),Object(k.jsx)(y.a,{children:Object(k.jsxs)(y.a.Body,{children:[Object(k.jsxs)(y.a.Title,{children:["Post #",e.id.toString()]}),f,Object(k.jsx)(S,{signer:e.signer,updateID:e.updateID,createNewFunction:function(t){return new O.a.Contract(v,w,e.signer).comment(e.id,t)},name:"New Comment"}),Object(k.jsx)(l.a,{variant:"secondary",onClick:function(){e.updateID(e.id)},children:"Make Primary"})]})})}function I(e){var t=Object(r.useState)(e.id),n=Object(j.a)(t,2),a=n[0],s=n[1],c=Object(r.useState)(e.id),i=Object(j.a)(c,2),d=i[0],l=i[1],b=Object(r.useState)([]),f=Object(j.a)(b,2),m=f[0],y=f[1],I=Object(r.useState)([]),D=Object(j.a)(I,2),N=D[0],_=D[1],T=Object(r.useState)([]),P=Object(j.a)(T,2),A=P[0],B=P[1];return Object(r.useEffect)((function(){var t=new O.a.Contract(v,w,e.signer);(function(){var n=Object(u.a)(o.a.mark((function n(){var r,s,c,i,u,j,d;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("Fetching Data"),n.next=3,t.totalSupply();case 3:return r=n.sent,l(r),console.log(r.toString()),n.next=8,t.getParents(a);case 8:return s=n.sent,y(s),n.next=12,t.getBranches(a);case 12:return c=n.sent,_(c),n.next=16,e.signer.getAddress();case 16:return i=n.sent,n.next=19,t.balanceOf(i);case 19:u=n.sent,j=[],d=x.a.from(0);case 22:if(!d.lt(u)){n.next=31;break}return n.t0=j,n.next=26,t.tokenOfOwnerByIndex(i,d);case 26:n.t1=n.sent,n.t0.push.call(n.t0,n.t1);case 28:d=d.add(x.a.from(1)),n.next=22;break;case 31:B(j);case 32:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[a,e.signer]),Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("div",{className:"pb-3",children:Object(k.jsx)(S,{signer:e.signer,updateID:s,createNewFunction:function(t){return new O.a.Contract(v,w,e.signer).newThread(t)},name:"New Thread"})}),Object(k.jsx)(p.a,{onSubmit:function(e){e.preventDefault()},children:Object(k.jsxs)(p.a.Group,{as:h.a,children:[Object(k.jsx)(g.a,{sm:2,children:Object(k.jsx)("h3",{children:" Post Num: "})}),Object(k.jsx)(g.a,{sm:2,children:Object(k.jsx)(p.a.Control,{type:"number",value:a.toNumber(),onChange:function(e){var t=parseInt(e.target.value);if(t&&!(t<=0)){var n=x.a.from(t);n.gt(d)||s(n)}}})})]})}),Object(k.jsx)(F,{posts:m.map((function(t){return Object(k.jsx)(C,{id:t,signer:e.signer,updateID:s})})),title:"Parents"}),Object(k.jsxs)("div",{className:"pb-3",children:[Object(k.jsx)("h3",{children:"Current Post"}),Object(k.jsx)(C,{id:a,signer:e.signer,updateID:s})]}),Object(k.jsx)("div",{className:"pb-3",children:Object(k.jsx)(F,{posts:N.map((function(t){return Object(k.jsx)(C,{id:t,signer:e.signer,updateID:s})})),title:"Replies"})}),Object(k.jsx)("div",{className:"pb-3",children:Object(k.jsx)(F,{posts:A.map((function(t){return Object(k.jsx)(C,{id:t,signer:e.signer,updateID:s})})),title:"My Posts"})})]})}function F(e){var t=Object(r.useState)(!0),n=Object(j.a)(t,2),a=n[0],s=n[1];if(0===e.posts.length)return Object(k.jsx)(k.Fragment,{});var c=a?"Collapse":"Expand";return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)(h.a,{children:[Object(k.jsx)(g.a,{children:Object(k.jsx)("h3",{children:e.title})}),Object(k.jsx)(g.a,{children:Object(k.jsx)(l.a,{onClick:function(){return s(!a)},"aria-controls":e.title,"aria-expanded":a,children:c})})]}),Object(k.jsx)(m.a,{in:a,children:Object(k.jsx)("div",{children:e.posts})})]})}var D=function(){var e=Object(r.useState)(!1),t=Object(j.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(null),c=Object(j.a)(s,2),i=c[0],p=c[1],h=Object(r.useState)(""),g=Object(j.a)(h,2),m=g[0],v=g[1];function w(){return S.apply(this,arguments)}function S(){return(S=Object(u.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!0),e.next=3,window.ethereum.enable();case 3:return t=new O.a.providers.Web3Provider(window.ethereum),n=t.getSigner(),e.next=7,n.getAddress();case 7:r=e.sent,console.log("Got Address!"),console.log(r),v(r),p(n),a(!1);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=Object(k.jsx)(k.Fragment,{}),C=Object(k.jsx)(k.Fragment,{});return n?y=Object(k.jsx)(d.a,{animation:"border",role:"status"}):null==i?y=Object(k.jsx)(l.a,{onClick:Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:case"end":return e.stop()}}),e)}))),children:"Connect Wallet"}):(y=Object(k.jsxs)("p",{children:["User Address: ",m]}),C=Object(k.jsx)(I,{id:x.a.from(1),signer:i})),Object(k.jsx)("div",{className:"App",children:Object(k.jsxs)(f.a,{children:[Object(k.jsxs)(b.a,{children:[Object(k.jsx)("h1",{children:"Tree Chan Frontend"}),y]}),C]})})},N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,98)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))};n(86);c.a.render(Object(k.jsx)(a.a.StrictMode,{children:Object(k.jsx)(D,{})}),document.getElementById("root")),N()}},[[87,1,2]]]);
//# sourceMappingURL=main.2fd002ff.chunk.js.map